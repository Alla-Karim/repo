{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>Tableau de bord Admin</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container">
    <a class="navbar-brand" href="#">Admin Dashboard</a>
    <div class="d-flex">
      <a href="{% url 'admin:index' %}" class="btn btn-outline-light me-2">Interface Admin Django</a>
      <a href="{% url 'home' %}" class="btn btn-outline-light">Déconnexion</a>
    </div>
  </div>
</nav>

<div class="container my-4">
  <h1 class="mb-4">Bienvenue, {{ request.user.username }}</h1>

  <section class="mb-5">
    <h2>Liste des opérateurs</h2>
    <table class="table table-striped table-bordered">
      <thead class="table-primary">
        <tr>
          <th>Nom</th>
          <th>Prénom</th>
          <th>Email</th>
        </tr>
      </thead>
      <tbody>
        {% for op in operateurs %}
        <tr>
          <td>{{ op.nom }}</td>
          <td>{{ op.prenom }}</td>
          <td>{{ op.email }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="3" class="text-center">Aucun opérateur trouvé</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <section class="mb-5">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h2 class="mb-0">Liste des machines</h2>
      <a href="{% url 'export_excel' %}" class="btn btn-success">Télécharger Excel</a>
    </div>
    <table class="table table-striped table-bordered">
      <thead class="table-success">
        <tr>
          <th>Référence</th>
          <th>Poste</th>
          <th>État</th>
          <th>Date d'achat</th>
          <th>Date dernière maintenance</th>
        </tr>
      </thead>
      <tbody>
        {% for machine in machines %}
        <tr>
          <td>{{ machine.ref_constructeur }}</td>
          <td>
            {% if machine.poste %}
              {{ machine.poste.nom }}
            {% else %}
              N/A
            {% endif %}
          </td>
          <td>{{ machine.etat }}</td>
          <td>{{ machine.date_achat }}</td>
          <td>{{ machine.date_derniere_maintenance|default:"-" }}</td>
        </tr>
        {% empty %}
        <tr><td colspan="5" class="text-center">Aucune machine trouvée</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

  <section class="mb-5">
    <h2>Liste des saisisseurs</h2>
    <a href="{% url 'saisisseur_add' %}" class="btn btn-primary mb-3">Ajouter un saisisseur</a>
    <table class="table table-striped table-bordered">
      <thead class="table-warning">
        <tr>
          <th>Nom d'utilisateur</th>
          <th>Email</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for user in saisisseurs %}
        <tr>
          <td>{{ user.username }}</td>
          <td>{{ user.email }}</td>
          <td>
            <a href="{% url 'saisisseur_delete' user.pk %}" class="btn btn-sm btn-danger"
               onclick="return confirm('Confirmer la suppression de {{ user.username }} ?');">Supprimer</a>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="3" class="text-center">Aucun saisisseur trouvé</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>

</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
